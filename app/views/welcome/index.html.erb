<br/><h1 class="text-center text-white">Welcome to the arena !</h1><br/>

<%= simple_form_for Fight.new, url: fights_path do |f| %>
  <div class="container">
    <div class="row">
      <div class="col-sm">
        <div id="first_character_picture_id" class="text-center"></div>
        <%= f.label :first_character_id, 'First character', class: "form-check-label text-white" %>
        <%= f.collection_select :first_character_id, Character.all, :id, :name, prompt: true %>
        <br/>
      </div>
      <div class="col-sm">
        <div id="second_character_picture_id" class="text-center"></div>
        <%= f.label :second_character_id, 'Second character', class: "form-check-label text-white" %>
        <%= f.collection_select :second_character_id, Character.all, :id, :name, prompt: true %>
        <br/>
      </div>
    </div>
    <br/>
    <div class="text-center">
      <%= f.submit 'Ready? Fight!', class: 'btn btn-primary' %>
    </div>

  </div>
<% end %>





<script type="text/javascript">
  $("select").addClass("form-control");

  // when first character has been selected, its picture shows up
  $("#fight_first_character_id").change(function() {
    if($(this).val() != ''){ $.post( "/first_character_picture", { id: $(this).val() } ); }
  });

  // when second character has been selected, its picture shows up
  $("#fight_second_character_id").change(function() {
    if($(this).val() != ''){ $.post( "/second_character_picture", { id: $(this).val() } ); }
  });

  // when a character try to fight himself, the fight is cancelled
  $("#new_fight").submit(function(event) {
    var firstCharacterValue = $("#fight_first_character_id").val();
    var secondCharacterValue = $("#fight_second_character_id").val();
    if(firstCharacterValue == secondCharacterValue){
      alert("A character can't fight against himself.");
      event.preventDefault();
    }

  });

</script>
